{% extends "layout.html.twig" %}
{% block content %}
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link href="{{ asset('css/fiche_projet.css') }}" rel="stylesheet" type="text/css" />

    <section>
        <article>
        <h2>{{ project.name }}</h2>
        <h3>Catégorie : {{ project.category }}</h3>
        <p>{{ project.description }}</p>
        </article>

        <article class="picto">
            <i class="fa fa-map-marker" aria-hidden="true"></i>
            <p>{{ project.address }} {{ project.cp }} {{ project.city }}</p>

            <i class="fa fa-calendar" aria-hidden="true"></i>
            <p>Du : {{ project.dateBegin|date('d-m-Y')}}</p>
            <p>Au : {{ project.dateEnd|date('d-m-Y')}}</p>

            <i class="fa fa-users" aria-hidden="true"></i>
            <p>{{ project.participant }}</p>

        </article>

        <button><a href="{{ path('nous-soutenir') }}">Nous Soutenir</a></button>
    </section>

    <section id="button">
    {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
        {% if project.statut == "en_cours" %}
            {% if project.hasUser(app.user) %}
                <p>Votre participation a déjà été enregistrée.</p>
            {% else %}
                <button><a href="{{ path('participer', {projectId: project.id}) }}">Participer</a></button>
            {% endif %}
        {% elseif project.statut == "terminer" %}
            <p>Ce projet est terminé :</p>
            <button><a href="{{ path('nos-projets') }}">Retourner à la liste des projets</a></button>
        {% endif %}
    {% else %}
        {% if project.statut == "terminer" %}
            <p>Ce projet est terminé :</p>
            <button><a href="{{ path('nos-projets') }}">Retourner à la liste des projets</a></button>
        {% elseif project.statut == "en_cours" %}
            <p>Pour Participer Veuillez vous connectez.</p>
            <button><a href="{{ path('fos_user_security_login') }}">{{ 'layout.login'|trans({}, 'FOSUserBundle') }}</a></button>
        {% endif %}
    {% endif %}
    </section>

    <img src="{{ asset('img/' ~ project.photo) }} " alt="{{ project.name }}">
    <div id="map"></div>



{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        var projectLocation = '{{ project.address }} {{ project.cp }} {{ project.city }}';
    </script>
    <script src="{{ asset('js/maps.js') }}"></script>



    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCeo_2NH70yX-yHGMr48vcTMyaKi5QUulc&callback=initMap">
    </script>
{% endblock %}